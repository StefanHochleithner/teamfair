<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TeamFair Übersicht</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f4f4f4;
      padding: 2rem;
    }
    h1 {
      color: #222;
    }
    .day-section {
      background: white;
      padding: 1rem;
      margin-bottom: 1.5rem;
      border-radius: 0.5rem;
      box-shadow: 0 0 6px rgba(0,0,0,0.1);
    }
    .team {
      margin-top: 0.5rem;
      padding: 0.5rem;
      background-color: #eef;
      border-radius: 0.3rem;
    }
    .team h3 {
      margin-top: 0;
    }
  </style>
  <script src="data.js"></script>
</head>
<body>
  <h1>⚽ TeamFair Übersicht</h1>
  <div id="output"></div>

  <script>
    function formatDateLabel(iso) {
      const date = new Date(iso);
      return date.toLocaleDateString("de-AT", {
        weekday: "long",
        day: "2-digit",
        month: "2-digit",
        year: "numeric"
      });
    }

    function listAllSavedMatchdays() {
      const output = document.getElementById("output");
      output.innerHTML = "";

      const keys = Object.keys(localStorage)
        .filter(k => k.startsWith("approved_players_"))
        .sort()
        .reverse();

      if (keys.length === 0) {
        output.innerHTML = "<p>⛔ Noch keine gespeicherten Spieltage.</p>";
        return;
      }

      keys.forEach(key => {
        const isoDate = key.replace("approved_players_", "");
        const dateLabel = formatDateLabel(isoDate);
        const players = JSON.parse(localStorage.getItem(key));

        const container = document.createElement("div");
        container.className = "day-section";
        container.innerHTML = `
          <h2>${dateLabel}</h2>
          <p><strong>Spieler:</strong> ${players.join(", ")}</p>
        `;

        if (players.length >= 2) {
          const shuffled = [...players].sort(() => Math.random() - 0.5);
          const half = Math.ceil(shuffled.length / 2);
          const teamA = shuffled.slice(0, half);
          const teamB = shuffled.slice(half);

          const teamDiv = document.createElement("div");
          teamDiv.className = "team";
          teamDiv.innerHTML = `
            <h3>Team A:</h3><p>${teamA.join(", ")}</p>
            <h3>Team B:</h3><p>${teamB.join(", ")}</p>
          `;
          container.appendChild(teamDiv);
        }

        output.appendChild(container);
      });
    }

    listAllSavedMatchdays();
  </script>
</body>
</html>
